<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Result · ModiaMath</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>ModiaMath</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search.html"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../index.html">Home</a></li><li><span class="toctext">Manual</span><ul><li><a class="toctext" href="../man/Overview.html">Overview</a></li><li><a class="toctext" href="../man/Plans.html">Plans for version 1.0</a></li></ul></li><li><span class="toctext">Library</span><ul><li><a class="toctext" href="SimulationEngine.html">SimulationEngine</a></li><li class="current"><a class="toctext" href="Result.html">Result</a><ul class="internal"></ul></li><li><a class="toctext" href="DAE.html">DAE</a></li><li><a class="toctext" href="NonlinearEquations.html">NonlinearEquations</a></li><li><a class="toctext" href="Variables.html">Variables</a></li><li><a class="toctext" href="Logging.html">Logging</a></li><li><a class="toctext" href="Frames.html">Frames</a></li><li><a class="toctext" href="Utilities.html">Utilities</a></li><li><a class="toctext" href="ModiaMath.html">Constants and Types</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>Library</li><li><a href="Result.html">Result</a></li></ul><a class="edit-page" href="https://github.com/ModiaSim/ModiaMath.jl/blob/master/docs/src/lib/Result.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Result</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Result-1" href="#Result-1">Result</a></h1><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="ModiaMath.Result" href="#ModiaMath.Result"><code>ModiaMath.Result</code></a> — <span class="docstring-category">Module</span>.</div><div><div><pre><code class="language-none">module ModiaMath.Result</code></pre><p>Organize and plot simulation result data (time series). The result data of <a href="SimulationEngine.html#ModiaMath.SimulationEngine.simulate!-Tuple{ModiaMath.AbstractSimulationModel}"><code>ModiaMath.simulate!</code></a> is returned in one of the formats supported by this module. The <a href="Result.html#ModiaMath.Result.plot-Tuple{Any,Symbol}"><code>ModiaMath.plot</code></a> function of this module allows to plot the result data by giving the signal names. The legends/labels of the plots are automatically constructed by the signal names and their unit. Example:</p><pre><code class="language-julia">ModiaMath.plot(result, [ (:phi,:r)      (:phi,:phi2,:w);
                         (:w,:w2,:phi2) (:phi,:w)      ], 
               heading=&quot;Matrix of plots&quot;)</code></pre><p>generates the following plot:</p><p><img src="../../resources/images/matrix-of-plots.svg" alt="Matrix-of-Plots"/></p><p><strong>Main developer</strong></p><p><a href="https://rmc.dlr.de/sr/de/staff/martin.otter/">Martin Otter</a>,  <a href="https://www.dlr.de/sr/en">DLR - Institute of System Dynamics and Control</a></p></div></div><a class="source-link" target="_blank" href="https://github.com/ModiaSim/ModiaMath.jl/blob/f2fe8e7e030068a84a0d87cc2895fb3f3c26372e/src/Result/_module.jl#L4-L28">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="ModiaMath.Result.RawResult" href="#ModiaMath.Result.RawResult"><code>ModiaMath.Result.RawResult</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-none">mutable struct RawResult</code></pre><p>Hold result data in a Float64 matrix (first column time, i-th column variable i). Typical usage:</p><pre><code class="language-none">    raw = RawResult(100,3) # Initial storage: 100 time points, 3 variables
    storeRawResult!(raw, [1.0, 2.0, 1.0])
    storeRawResult!(raw, [2.0, 3.0, 5.0])
      ...
    res = getDictResult(res, [&quot;time&quot;, &quot;r[1]&quot;, &quot;r[2]&quot;]
    
    plot(res[&quot;time&quot;], res[&quot;r[1]&quot;])</code></pre><p>If initial storage is not sufficient, it is automatically doubled.</p></div></div><a class="source-link" target="_blank" href="https://github.com/ModiaSim/ModiaMath.jl/blob/f2fe8e7e030068a84a0d87cc2895fb3f3c26372e/src/Result/rawResult.jl#L8-L25">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="ModiaMath.Result.ResultWithVariables" href="#ModiaMath.Result.ResultWithVariables"><code>ModiaMath.Result.ResultWithVariables</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-none">mutable struct ResultWithVariables</code></pre><p>Struct that is generated as a result of ModiaMath.simulate!(...), if the model is a Modia3D.AbstractComponentWithVariables struct.</p></div></div><a class="source-link" target="_blank" href="https://github.com/ModiaSim/ModiaMath.jl/blob/f2fe8e7e030068a84a0d87cc2895fb3f3c26372e/src/Result/result.jl#L254-L259">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="ModiaMath.Result.closeAllFigures-Tuple{}" href="#ModiaMath.Result.closeAllFigures-Tuple{}"><code>ModiaMath.Result.closeAllFigures</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">ModiaMath.closeAllFigures()</code></pre><p>Closes all open figures.</p></div></div><a class="source-link" target="_blank" href="https://github.com/ModiaSim/ModiaMath.jl/blob/f2fe8e7e030068a84a0d87cc2895fb3f3c26372e/src/Result/plotResult.jl#L133-L137">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="ModiaMath.Result.closeFigure-Tuple{Int64}" href="#ModiaMath.Result.closeFigure-Tuple{Int64}"><code>ModiaMath.Result.closeFigure</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">ModiaMath.closeFigure(figure::Int)</code></pre><p>Closes figure with figure number <code>figure</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/ModiaSim/ModiaMath.jl/blob/f2fe8e7e030068a84a0d87cc2895fb3f3c26372e/src/Result/plotResult.jl#L125-L129">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="ModiaMath.Result.getStringDictResult-Tuple{Any,ModiaMath.Result.RawResult}" href="#ModiaMath.Result.getStringDictResult-Tuple{Any,ModiaMath.Result.RawResult}"><code>ModiaMath.Result.getStringDictResult</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">getStringDictResult(model, res)</code></pre><p>Return dictionary of result, from raw result data structure <code>raw</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/ModiaSim/ModiaMath.jl/blob/f2fe8e7e030068a84a0d87cc2895fb3f3c26372e/src/Result/result.jl#L22-L26">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="ModiaMath.Result.plot-Tuple{Any,Symbol}" href="#ModiaMath.Result.plot-Tuple{Any,Symbol}"><code>ModiaMath.Result.plot</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">ModiaMath.plot(result, names; heading=&quot;&quot;, grid=true, xAxis= :time, 
               figure=1, prefix=&quot;&quot;, reuse=false, maxLegend=10)</code></pre><p>Plot time series of the result defined by the names keys (Symbol or String). The keys (and their units, if available in the result) are automatically used as legend. Units can be either added by using package <code>Unitful</code> if result is just a dictionary, or it can be added by using package <code>ModiaMath.Result</code>, where units are defined as elements of the variable definition. </p><p><strong>Arguments</strong></p><p>Argument <code>result</code> maybe one of the following:</p><ul><li>A dictionary <code>Dict{AbstractString,Any}</code>. The Dict Value can be <br/>(a) <code>Vector{Number}</code>,<br/>(b) <code>Matrix{Number}</code>,<br/>(c) a vector of structs where the field that shall be plotted is a <code>Number</code>, or<br/>(d) a vector of structs and a function is provided to compute a <code>Number</code> from the struct (this function must be stored as value in a dictionary <code>Dict{AbstractString,Function}</code> and this dictionary is returned from function <code>ModiaMath.variablesDependingOnStruct(struct);</code> see last example below).<br/>Note, before passing data to the plot package, it is converted to Float64. This allows to, for example, also plot rational numbers, even if not supported by the plot package. </li><li>An instance of struct <a href="Result.html#ModiaMath.Result"><code>ModiaMath.Result</code></a></li><li>An object for which function <a href="Result.html#ModiaMath.Result.resultTimeSeries-Tuple{Dict{AbstractString,Any},Any,Bool,Any}"><code>ModiaMath.resultTimeSeries</code></a> is defined.</li></ul><p>Argument <code>names</code> defines the diagrams to be drawn and the time series to be included in the respective diagram: </p><ul><li>If names is a <strong>Symbol</strong> or <strong>String</strong>, generate one diagram with one time series.</li><li>If names is a <strong>Tuple</strong> of Symbols/Strings, generate one diagram with the time series of the given keys</li><li>If names is a <strong>Vector</strong> or <strong>Matrix</strong> of Symbols/Strings/Tuples, generate a vector or matrix of diagrams.</li></ul><p>Remaining arguments:</p><ul><li><code>heading::AbstractString</code>: Optional heading above the diagram.</li><li><code>grid::Bool</code>: Optional grid.</li><li><code>xAxis</code>: Name of x-axis (Symbol or AbstractString).</li><li><code>figure::Int</code>: Integer identifier of the window in which the diagrams shall be drawn.</li><li><code>prefix::AbstractString</code>: String that is appended in front of every legend label (useful especially if reuse=true)</li><li><code>reuse::Bool</code>: If figure already exists and reuse=false, clear the figure before adding the plot.</li><li><code>maxLegend::Int</code>: If the number of legend entries in one plot command &gt; maxLegend, the legend is suppressed. All curves have still their names as labels. The curves can be inspected by their names by clicking in the toolbar of the plot on button <code>Edit axis, curve ..</code> and then on <code>Curves</code>.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia">import ModiaMath
using Unitful

t = linspace(0.0, 10.0, 100)
result = Dict{AbstractString,Any}(
            &quot;time&quot; =&gt; t*u&quot;s&quot;, &quot;phi1&quot; =&gt; sin.(t)u&quot;rad&quot;  , &quot;phi2&quot; =&gt; 0.5*sin.(t),
                              &quot;w1&quot;   =&gt; cos.(t)u&quot;rad/s&quot;, &quot;w2&quot;   =&gt; 0.6*cos.(t))

# 1 signal in one diagram
#   (legend = &quot;phi1 [rad]&quot;)
ModiaMath.plot(result, :phi1)   

# 3 signals in one diagram                                 
ModiaMath.plot(result, (&quot;phi1&quot;, :phi2, :w1), figure=2)

# 3 diagrams in form of a vector (every diagram has one signal)                 
ModiaMath.plot(result, [:phi1, :phi2, :w1], figure=3)     

# 4 diagrams in form of a matrix (every diagram has one signal)          
ModiaMath.plot(result, [&quot;phi1&quot; &quot;phi2&quot;;
                        &quot;w1&quot;   &quot;w2&quot;   ], figure=4)     

# 2 diagrams in form of a vector           
ModiaMath.plot(result, [ (:phi1,:phi2), (:w1) ], figure=5)           

# 4 diagrams in form of a matrix
ModiaMath.plot(result, [ (:phi1,)           (:phi2,:w1);
                         (:phi1,:phi2,:w1)  (:w2,)     ],figure=6)  

# Plot w1=f(phi1) in one diagram 
ModiaMath.plot(result, :w1, xAxis=:phi1, figure=7)    

# Append signal of the next simulation run to figure=1
# (legend = &quot;Sim 2: phi1 [rad]&quot;)
result[:phi1] = 0.5*result[:phi1]
ModiaMath.plot(result, :phi1, prefix=&quot;Sim 2: &quot;, reuse=true)

# Compute and plot variables that depend on the result vector
mutable struct MyThermodynamicState
    p::Float64
    T::Float64
end
specificEnthalpy(state::MyThermodynamicState) = 2.0*state.T
dynamicViscosity(state::MyThermodynamicState) = 2.0*state.p

const dependentVariables = Dict{AbstractString,Function}(&quot;h&quot;   =&gt; specificEnthalpy,
                                                         &quot;eta&quot; =&gt; dynamicViscosity)

ModiaMath.variablesDependingOnStruct(state::MyThermodynamicState) = dependentVariables

state = MyThermodynamicState[]
for i = 1:length(t)
    push!(state, MyThermodynamicState(i*2.0,i*3.0))
end
result = Dict{AbstractString,Any}(&quot;time&quot; =&gt; t, &quot;state&quot; =&gt; state)

ModiaMath.plot(result, (&quot;state.p&quot;, &quot;state.T&quot;, &quot;state.h&quot;, &quot;state.eta&quot;))</code></pre><p>The 5th example above (2 diagrams in form of a vector) give the following plot:</p><p><img src="../../resources/images/plot_figure5.svg" alt="Figure 5"/></p></div></div><a class="source-link" target="_blank" href="https://github.com/ModiaSim/ModiaMath.jl/blob/f2fe8e7e030068a84a0d87cc2895fb3f3c26372e/src/Result/plotResult.jl#L9-L117">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="ModiaMath.Result.resultTable-Tuple{Dict{AbstractString,Any}}" href="#ModiaMath.Result.resultTable-Tuple{Dict{AbstractString,Any}}"><code>ModiaMath.Result.resultTable</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">table = resultTable(result)</code></pre><p>Return the variables stored in <code>result</code> in form of a DataFrames table (which can then be printed/showed in various forms).</p><p><code>Base.show(io, result)</code> is defined to print <code>resultTable(result)</code>, in case result is of type ModiaMath.ResultWithVariables.</p><p><strong>Examples</strong></p><pre><code class="language-julia">import ModiaMath
using  Unitful

t = range(0.0, stop=10.0, length=100)
result = Dict{AbstractString,Any}()
result[&quot;time&quot;] = t * u&quot;s&quot;;
result[&quot;phi&quot;]  = sin.(t)u&quot;rad&quot;;

# Print table of the variables that are stored in result
println(&quot;result variables = &quot;, ModiaMath.resultTable(result))

# Results in
result variables =
│ Row │ name   │ elType  │ sizeOrValue   │ unit   │
│     │ String │ String  │ String        │ String │
├─────┼────────┼─────────┼───────────────┼────────┤
│ 1   │ phi    │ Float64 │ (100,)        │ rad    │
│ 2   │ time   │ Float64 │ (100,)        │ s      │
</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/ModiaSim/ModiaMath.jl/blob/f2fe8e7e030068a84a0d87cc2895fb3f3c26372e/src/Result/result.jl#L181-L213">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="ModiaMath.Result.resultTimeSeries-Tuple{Dict{AbstractString,Any},Any,Bool,Any}" href="#ModiaMath.Result.resultTimeSeries-Tuple{Dict{AbstractString,Any},Any,Bool,Any}"><code>ModiaMath.Result.resultTimeSeries</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">(xsig, xsigLegend, ysig, ysigLegend) = 
       ModiaMath.resultTimeSeries(result, name, xLabel::Bool, xAxis)</code></pre><p>For a desired <code>result</code> data structure, this function has to be provided to return the x-vector (<code>xsig</code>), the y-vector (<code>ysig</code>) and the legend of the x-vector (<code>xsigLegend</code>), and of the y-vector (<code>ysigLegend</code>) as Strings, given  the key of the y-vector (<code>name</code>) and the key of the x-vector (<code>xAxis</code>). If <code>xLabel=false</code> the legend of the x-vector should be an empty string (<code>&quot;&quot;</code>).</p></div></div><a class="source-link" target="_blank" href="https://github.com/ModiaSim/ModiaMath.jl/blob/f2fe8e7e030068a84a0d87cc2895fb3f3c26372e/src/Result/result.jl#L118-L127">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="ModiaMath.Result.storeRawResult!-Tuple{ModiaMath.Result.RawResult,Array{Float64,1}}" href="#ModiaMath.Result.storeRawResult!-Tuple{ModiaMath.Result.RawResult,Array{Float64,1}}"><code>ModiaMath.Result.storeRawResult!</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">storeRawResult!(res, v::Vector{Float64})</code></pre><p>Store vector <code>v</code> in result data structure <code>res</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/ModiaSim/ModiaMath.jl/blob/f2fe8e7e030068a84a0d87cc2895fb3f3c26372e/src/Result/rawResult.jl#L41-L45">source</a></section><footer><hr/><a class="previous" href="SimulationEngine.html"><span class="direction">Previous</span><span class="title">SimulationEngine</span></a><a class="next" href="DAE.html"><span class="direction">Next</span><span class="title">DAE</span></a></footer></article></body></html>
